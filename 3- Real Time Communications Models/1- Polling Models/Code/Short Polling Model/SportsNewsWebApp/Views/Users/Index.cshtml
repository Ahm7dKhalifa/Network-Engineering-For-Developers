@{
    ViewData["Title"] = "Users";
}

<div class="container">
    <div class="row">
        <div class="col-8">
            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel" data-interval="3000">
                <!-- Carousel Indicators -->
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleIndicators" data-slide-to="0"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="1" class="active"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                </ol>

                <!-- Carousel Images with Captions -->
                <div class="carousel-inner">
                    <div class="carousel-item">
                        <img class="d-block w-100" src="~/images/slides-1.jpg" alt="First slide">
                        <div class="carousel-caption d-block bg-primary text-white p-2">
                            <h5>محمد صلاح</h5>
                            <p>ليفربول يواجه مانشيستر سيتي اليوم</p>
                        </div>
                    </div>
                    <div class="carousel-item active">
                        <img class="d-block w-100" src="~/images/slides-2.jpg" alt="Second slide">
                        <div class="carousel-caption d-block bg-primary text-white p-2">
                            <h5>زمالك</h5>
                            <p>شيكابالا يرفع الكاس</p>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="~/images/slides-3.jpg" alt="Third slide">
                        <div class="carousel-caption d-block bg-primary text-white p-2">
                            <h5>ناصر منسي</h5>
                            <p>حصري .. مقابلة صحفية مع ناصر منسي</p>
                        </div>
                    </div>
                </div>

                <!-- Carousel Controls -->
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
    </div>
</div>




<!------------------------------------------
--------------------------------------------
Include the polling script for notifications 
-------------------------------------------
------------------------------------------->
<!-- Toast container -->
<div id="toast-container" style="position: fixed; top: 70px; right: 20px; z-index: 1055;">
    <!-- Toast notifications will be appended here -->
</div>


@section Scripts{
    <script>
        // Function to poll notifications every 10 seconds
        setInterval(function () {
            $.ajax({
                url: '/Notifications/GetLatestNotifications',
                type: 'GET',
                success: function (data) {
                    if (data.length > 0) {
                        // Loop through notifications and show each
                        data.forEach(function (notification) {
                            var toastId = 'toast-' + notification.id;
                            // Append a new toast element to the toast container
                            $('#toast-container').append(
                                '<div id="' + toastId + '" class="toast fade show" role="alert" aria-live="assertive" aria-atomic="true">' +
                                '<div class="toast-header" style="background-color: green; color: white;">' +  // Pepsi blue background
                                '<i class="fa fa-bell" style="color: yellow; margin-right: 10px;"></i>' +
                                '<strong class="mr-auto"> New Notification </strong>' +
                                '</button>' +
                                '</div>' +
                                '<div class="toast-body">' +
                                notification.message +
                                '</div>' +
                                '</div>'
                            );

                            // Initialize the toast
                            $('#' + toastId).toast({ delay: 3000 }); // Auto-hide after 5 seconds
                            $('#' + toastId).toast('show');


                        });
                    }
                },
                error: function (error) {
                    console.error('Error fetching notifications:', error);
                }
            });
        }, 10000); // Poll every 10 seconds

        // Remove toasts when they're hidden
        $(document).on('hidden.bs.toast', '.toast', function () {
            $(this).remove(); // Remove toast from DOM after it's hidden
        });
    </script>
}



