@{
    ViewData["Title"] = "Users";
}
<h1>Sports News for Users</h1>

<p>Enjoy the latest sports news below:</p>
<img src="/images/sports-news.jpg" alt="Sports News" />


<!-- Include the polling script for notifications -->


<!-- Toast container -->
<div id="toast-container" style="position: fixed; bottom: 20px; right: 20px; z-index: 1055;">
    <!-- Toast notifications will be appended here -->
</div>

@section Scripts{
    <script>

        // Function to poll notifications every 10 seconds
        setInterval(function () {
            $.ajax({
                url: '/Notifications/GetLatestNotifications',
                type: 'GET',
                success: function (data) {
                    if (data.length > 0) {
                        // Loop through notifications and show each
                        data.forEach(function (notification) {
                            var toastId = 'toast-' + notification.id;
                            // Append a new toast element to the toast container
                            $('#toast-container').append(
                                '<div id="' + toastId + '" class="toast fade show" role="alert" aria-live="assertive" aria-atomic="true">' +
                                '<div class="toast-header" style="background-color: green; color: white;">' +  // Pepsi blue background
                                '<i class="fa fa-bell" style="color: yellow; margin-right: 10px;"></i>' +
                                '<strong class="mr-auto"> New Notification </strong>' +
                                '</button>' +
                                '</div>' +
                                '<div class="toast-body">' +
                                notification.message +
                                '</div>' +
                                '</div>'
                            );

                            // Initialize the toast
                            $('#' + toastId).toast({ delay: 3000 }); // Auto-hide after 5 seconds
                            $('#' + toastId).toast('show');


                        });
                    }
                },
                error: function (error) {
                    console.error('Error fetching notifications:', error);
                }
            });
        }, 10000); // Poll every 10 seconds

        // Remove toasts when they're hidden
        $(document).on('hidden.bs.toast', '.toast', function () {
            $(this).remove(); // Remove toast from DOM after it's hidden
        });
    </script>
}



